<!DOCTYPE html>

<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">

		<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Curl 과 Restful API | Tech Stock</title>
<meta name="generator" content="Jekyll v3.8.4" />
<meta property="og:title" content="Curl 과 Restful API" />
<meta name="author" content="hasune" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="JSON형식으로 리퀘스트를 보내며, Restful API로 설계된 웹어플의 스트레스 테스트를 하게되었다." />
<meta property="og:description" content="JSON형식으로 리퀘스트를 보내며, Restful API로 설계된 웹어플의 스트레스 테스트를 하게되었다." />
<link rel="canonical" href="http://localhost:4000/Linux/Curl-RESTfulAPI/" />
<meta property="og:url" content="http://localhost:4000/Linux/Curl-RESTfulAPI/" />
<meta property="og:site_name" content="Tech Stock" />
<script type="application/ld+json">
{"url":"http://localhost:4000/Linux/Curl-RESTfulAPI/","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/siteicon.png"},"name":"hasune"},"headline":"Curl 과 Restful API","author":{"@type":"Person","name":"hasune"},"description":"JSON형식으로 리퀘스트를 보내며, Restful API로 설계된 웹어플의 스트레스 테스트를 하게되었다.","@type":"Article","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

		<link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Tech Stock" />

		<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Merriweather:400,400italic,700,700italic|Open+Sans:400,400italic,600,600italic,700,700italic|Inconsolata:400,700">
		<link rel="stylesheet" href="/css/main.css">
		<link rel="apple-touch-icon" href="/apple-touch-icon.png">
		<link rel="icon" type="image/png" href="/touch-icon.png" sizes="192x192">
		<link rel="icon" type="image/png" href="/images/favicon.png">

		
	</head>

	<body>
		<header>
			<h1>
				<a href="/"><img src="/images/emblem.svg" width="40" height="40" alt="Tech Stock logo"></a>
				Tech Stock
				<button type="button" class="open-nav" id="open-nav"></button>
			</h1>

			<form action="/search/" method="get">
				<input type="text" name="q" id="search-input" placeholder="Search" autofocus>
				<input type="submit" value="Search" style="display: none;">
			</form>

			<nav class="full-navigation">
				<ul>
					<li class="nav-item top-level ">
						
						<a href="/">건망증이 심한 엔지니어</a>
					</li>
				</ul>

				<ul>
					
					
						<li class="nav-item top-level ">
							
							<a href="/AWS&Azure&Heroku/AWS-Basic1/">AWS&Azure&Heroku</a>
							<ul>
								
									<li class="nav-item "><a href="/AWS&Azure&Heroku/AWS-Basic1/">AWS의 기본개념과 구조</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/Accident&Trouble/honbang-delete/">Accident&Trouble</a>
							<ul>
								
									<li class="nav-item "><a href="/Accident&Trouble/honbang-delete/">혼방 데이터 삭제하고 상황 회피</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/Awesome%20Blogger/Blogger/">Awesome Blogger</a>
							<ul>
								
									<li class="nav-item "><a href="/Awesome%20Blogger/Blogger/">학습과 커리어에 도움되는 블로거들</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/Git&Github/Git-Commit/">Git&Github</a>
							<ul>
								
									<li class="nav-item "><a href="/Git&Github/Git-Commit/">Git으로 커밋하기</a></li>
								
									<li class="nav-item "><a href="/Git&Github/Git-Branch/">Git에서 Branch관리</a></li>
								
									<li class="nav-item "><a href="/Git&Github/Git-Conflict/">Conflict관리</a></li>
								
									<li class="nav-item "><a href="/Git&Github/Git-Different-PullFetchClone/">Pull Fetch Clone Rebase Fork</a></li>
								
									<li class="nav-item "><a href="/Git&Github/Github-PullRequest/">GitHub의 PullRequest</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/IDE&Editor/Eclipse-shortcutkey/">IDE&Editor</a>
							<ul>
								
									<li class="nav-item "><a href="/IDE&Editor/Eclipse-shortcutkey/">Eclipse Shortcut Key</a></li>
								
									<li class="nav-item "><a href="/IDE&Editor/vi-vim-shorcutkey/">VI & VIM editor Shortcut key</a></li>
								
									<li class="nav-item "><a href="/IDE&Editor/VScode-Extends/">VScode 유용한 확장어플</a></li>
								
									<li class="nav-item "><a href="/IDE&Editor/VScode-setting/">VScode 유용한 설정들</a></li>
								
									<li class="nav-item "><a href="/IDE&Editor/VScode-shortcutkey/">VScode 유용한 단축키</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/Java/Array-List/">Java</a>
							<ul>
								
									<li class="nav-item "><a href="/Java/Array-List/">ArrayList 개념정리</a></li>
								
									<li class="nav-item "><a href="/Java/HashMap/">HashMap 개념정리</a></li>
								
									<li class="nav-item "><a href="/Java/Generic/">Generic이란 어떤놈인가</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level current">
							
							<a href="/Linux/BashShell-Mybest/">Linux</a>
							<ul>
								
									<li class="nav-item "><a href="/Linux/BashShell-Mybest/">BashShell 젤 많이 썼던 놈들 정리</a></li>
								
									<li class="nav-item "><a href="/Linux/BashShell-ShortCutKey/">BashShell 기본단축키 정리</a></li>
								
									<li class="nav-item "><a href="/Linux/BashShell-Redirect/">BashShell 리다이렉트 정리</a></li>
								
									<li class="nav-item current"><a href="/Linux/Curl-RESTfulAPI/">Curl 과 Restful API</a></li>
								
									<li class="nav-item "><a href="/Linux/etc-hosts/">Linux에서 /etc/hosts 에 대해</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/Mybatis/Basic-Structure/">Mybatis</a>
							<ul>
								
									<li class="nav-item "><a href="/Mybatis/Basic-Structure/">마이바티스의 기본구조</a></li>
								
									<li class="nav-item "><a href="/Mybatis/Basic1/">마이바티스의 기본사용</a></li>
								
									<li class="nav-item "><a href="/Mybatis/HandleResult/">대량쿼리문에 좋은 핸들 리절트</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/Oracle/JOIN/">Oracle</a>
							<ul>
								
									<li class="nav-item "><a href="/Oracle/JOIN/">Join</a></li>
								
									<li class="nav-item "><a href="/Oracle/SUB-QUERY/">Sub-query</a></li>
								
									<li class="nav-item "><a href="/Oracle/VIEW/">View</a></li>
								
									<li class="nav-item "><a href="/Oracle/INDEX/">Index</a></li>
								
									<li class="nav-item "><a href="/Oracle/SEQUENCE/">Sequence</a></li>
								
									<li class="nav-item "><a href="/Oracle/Operator/">Operator 기본(연산자)</a></li>
								
									<li class="nav-item "><a href="/Oracle/Function/">Function 기본 함수</a></li>
								
									<li class="nav-item "><a href="/Oracle/If-For-Case/">If문 For문 Case문</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/Performance/DB-Index1/">Performance</a>
							<ul>
								
									<li class="nav-item "><a href="/Performance/DB-Index1/">DB에서 Index를 통한 성능개선 1</a></li>
								
									<li class="nav-item "><a href="/Performance/DB-Index2/">DB에서 Index를 통한 성능개선 2</a></li>
								
									<li class="nav-item "><a href="/Performance/managed-programming/">성능을 염두한 프로그래밍</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/Postgres/JOIN/">Postgres</a>
							<ul>
								
									<li class="nav-item "><a href="/Postgres/JOIN/">Join 오라클과 비교</a></li>
								
									<li class="nav-item "><a href="/Postgres/SUB-QUERY/">Sub-query 오라클과 비교</a></li>
								
									<li class="nav-item "><a href="/Postgres/VIEW/">View 오라클과 비교</a></li>
								
									<li class="nav-item "><a href="/Postgres/INDEX/">Index 오라클과 비교</a></li>
								
									<li class="nav-item "><a href="/Postgres/SEQUENCE/">Sequence 오라클과 비교</a></li>
								
									<li class="nav-item "><a href="/Postgres/Operator/">Operator 기본(연산자) 오라클과 비교</a></li>
								
									<li class="nav-item "><a href="/Postgres/Function/">Function 오라클과 비교</a></li>
								
									<li class="nav-item "><a href="/Postgres/If-For-Case/">If문 For문 Case문 오라클과 비교</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/Regular%20expression/regexp-with-java/">Regular expression</a>
							<ul>
								
									<li class="nav-item "><a href="/Regular%20expression/regexp-with-java/">자바에서의 정규표현</a></li>
								
									<li class="nav-item "><a href="/Regular%20expression/regexp-with-linux/">리눅스 에서의 정규표현</a></li>
								
									<li class="nav-item "><a href="/Regular%20expression/regexp-with-oracle/">오라클 에서의 정규표현</a></li>
								
									<li class="nav-item "><a href="/Regular%20expression/regexp-with-postgres/">포스그레 에서의 정규표현</a></li>
								
									<li class="nav-item "><a href="/Regular%20expression/regexp-with-ruby/">루비 에서의 정규표현</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/Ruby/Rails-basic1/">Ruby</a>
							<ul>
								
									<li class="nav-item "><a href="/Ruby/Rails-basic1/">Rails 기초</a></li>
								
									<li class="nav-item "><a href="/Ruby/Rails-basic2/">scafflod 어떤놈이냐</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/Scrap/explain-scrap/">Scrap</a>
							<ul>
								
									<li class="nav-item "><a href="/Scrap/explain-scrap/">제대로된 설명</a></li>
								
									<li class="nav-item "><a href="/Scrap/Trendy-tool/">유행하는 툴</a></li>
								
									<li class="nav-item "><a href="/Scrap/video/">좋은 영상</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/Security/EX/">Security</a>
							<ul>
								
									<li class="nav-item "><a href="/Security/EX/">해킹 유형과 사례</a></li>
								
									<li class="nav-item "><a href="/Security/security-DB/">보안을 염두한 DB관리</a></li>
								
									<li class="nav-item "><a href="/Security/security-coding/">보안을 염두한 프로그래밍</a></li>
								
									<li class="nav-item "><a href="/Security/security-linux/">보안을 염두한 Linux관리</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/Spring/Basic-Structure1/">Spring</a>
							<ul>
								
									<li class="nav-item "><a href="/Spring/Basic-Structure1/">스프링 기본구조 1</a></li>
								
									<li class="nav-item "><a href="/Spring/Basic-Structure2/">스프링 기본구조 2</a></li>
								
									<li class="nav-item "><a href="/Spring/Dependency-Injection/">DI 의존주입</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/Sub-Project/1Day/">Sub-Project</a>
							<ul>
								
									<li class="nav-item "><a href="/Sub-Project/1Day/">서브프로젝트 첫날</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/Trend&News/2019-Stackoverflow/">Trend&News</a>
							<ul>
								
									<li class="nav-item "><a href="/Trend&News/2019-Stackoverflow/">2019 스택오버플로어 설문조사</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/Youtuber/Youtuber/">Youtuber</a>
							<ul>
								
									<li class="nav-item "><a href="/Youtuber/Youtuber/">학습과 커리어에 도움되는 유튜버</a></li>
								
							</ul>
						</li>
					
				</ul>

				<ul>
					<li class="nav-item top-level ">
						
						<a href="/changelog/">Change Log</a>
					</li>
				</ul>
			</nav>
		</header>

		<section class="main">
			<div class="page-header">
				<h2>Linux</h2>
				<h3>Curl 과 Restful API</h3>
			</div>
			<article class="content">
				<h5><p>JSON형식으로 리퀘스트를 보내며,<br />
Restful API로 설계된 웹어플의 스트레스 테스트를 하게되었다.</p>

<p>보통 테스트를 위해서 툴을 많이들 쓰는데<br />
한번의 리퀘스트에 대해서 어떤 리스폰스가 오는가 를 보기 위해선 좋지만,<br />
동시다발적으로 몇십건의 리퀘스트 요청을 보내야 하며, <br />
그 리퀘스트에 대한 리스폰스가 각각 몇초 걸리는지 시간을 측정해야 할경우<br />
GUI환경에서 하기가 어렵다.<br />
그리하여.. linux환경에서 &amp;를 활용해서 <br />
복수의 처리가 백그라운에서 돌아가게 하는식으로 테스트를 하게되었고..<br />
서비스의 허용범위와 한계치 까지 테스트 해야하는상황.</p>
<ul>
  <li>1만건의 JSON데이터 전송,  1만건의 JSON데이터, 복수 전송</li>
  <li>10만건의 JSON데이터 전송, 10만건의 JSON데이터 복수전송</li>
  <li>50만건의 JSON데이터 전송, 50만건의 JSON데이터 복수전송</li>
</ul>

<p>이런것들을 테스트 해봐야할 사람이라면 참고가 되었으면 한다.
.<br />
.<br />
.</p>

<p>이것저것 주워담은 지식들을 정리</p>

<p>JSON형식의 POST일경우 가장 기본형</p>

<pre><code class="language-git">curl -X POST -H "Content-Type: application/json" -d '{"Name":"superman", "Age":"100"}' http://localhost/member
</code></pre>

<ul>
  <li>-X : 메서드설정</li>
  <li>-H : 헤더를 보낸다</li>
  <li>-d : 데이터를 전달한다(JSON데이터를 미니파이 하여 한줄짜리로 변경해서 복붙)</li>
</ul>

<p>JSON형식의 데이터가 저장되어있는 JSON_data.txt를 읽어드려서 리퀘스트 요청<br />
(JSON_data.txt에 대량 JSON데이터를 담아서 보낼때 좋다)</p>

<pre><code class="language-git">curl -X POST -H "Content-Type: application/json" -d @JSON_data.txt http://localhost/member
</code></pre>
<p>위와 같은 요청을 복수로 보낼때에는 &amp;로 계속 이어붙혀도됨</p>
<pre><code class="language-git">curl -X POST -H "Content-Type: application/json" -d @JSON_data1.txt http://localhost/member &amp; curl -X POST -H "Content-Type: application/json" -d @JSON_data2.txt http://localhost/
</code></pre>

<p>curl에서 -w 옵션으로 포맷을 설정할수 있다.<br />
포맷앞에 @를 붙이면 포맷을 지정한 파일을 설정할 수 있다.</p>

<pre><code class="language-git">$ curl -w "total %{time_toal}\n" http://localhost  #기본적인사용 

$ curl -w @format.txt http://localhost #포맷 지정을 따로 파일로 뺐을경우
</code></pre>

<p>포맷의 내용은 여러가지 지정 할 수 있는데, 더 자세한것은 man curl 을 참조<br />
밑의 내용은 cat format.txt 했을때의 내용이다.</p>

<pre><code class="language-git">http_code           %{http_code}\n
size_upload         %{size_upload}\n
speed_upload        %{speed_upload}\n
size_download       %{size_download}\n
speed_download      %{speed_download}\n
time_pretransfer    %{time_pretransfer}\n
time_starttransfer  %{time_starttransfer}\n
time_total          %{time_total}\n
</code></pre>

<p>위의 format.txt 를 읽어드려서 리퀘스트 요청한 결과값은 이런식으로 뜬다</p>

<pre><code class="language-git">http_code           200
size_upload         0
speed_upload        0.000
size_download       3
speed_download      1.000
time_pretransfer    0.002
time_starttransfer  2.166
time_total          2.167
</code></pre>
<p>http_code 200 이니  ok란 뜻이겠고 400이면 bad request 404면 not found로 생각하면됨</p>

<p>위의 결과를 리다이렉트 써서</p>
<pre><code class="language-git">curl -w "total %{time_toal}\n" http://localhost &gt; response.txt 
</code></pre>
<p>이런식으로 따로 빼도 되고</p>

<p>만약 리스폰스 값을 날려버리고 싶으면 -o 옵션에 /dev/null을 줘서 쓰면 된다.<br />
무거운 처리일경우 상태정보 표시가 나오는데 이것을 보고싶지 않으면 -s 를 붙힌다</p>
<ul>
  <li>-o : 아웃풋 설정</li>
  <li>-s : 프로그레스나 에러 정보를 보여주지 않는다</li>
</ul>

<pre><code class="language-git">curl -s -o /dev/null -w "total %{time_toal}\n" http://localhost &gt; response.txt 
</code></pre>

<p>아직 해본적은 없지만 유용할것 같은거라 추가 메모</p>

<blockquote>
  <p>http://localhost/helloworld로 요청보내고 응답쿠키를 cookie.txt에 저장</p>
</blockquote>

<pre><code class="language-git">$ curl -c cookie.txt http://localhost/helloworld
</code></pre>

<blockquote>
  <p>http://localhost/hellocurl로 저장한 쿠키를 헤더에 추가해서 리퀘스트 보낸다</p>
</blockquote>

<pre><code class="language-git">$ curl -b cookie.txt http://page2.example.com
</code></pre>

</h5>
				
  					<div id="disqus_thread"></div>
    <script>
        (function() { // DON'T EDIT BELOW THIS LINE
            var d = document, s = d.createElement('script');
            s.src = 'https://techstock-biz.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();
    </script>
<noscript>Please enable JavaScript to view the 
    <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>
                            
				
			</article>
		</section>

		<script>
			document.getElementById("open-nav").addEventListener("click", function () {
				document.body.classList.toggle("nav-open");
			});
		</script>
		<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-142178407-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-142178407-1');
</script>


	</body>
</html>
