<!DOCTYPE html>

<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">

		<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>보안을 염두한 Linux관리 | Tech Stock</title>
<meta name="generator" content="Jekyll v3.8.4" />
<meta property="og:title" content="보안을 염두한 Linux관리" />
<meta name="author" content="hasune" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="■ 그럭저럭 시큐어한 리눅스 서버구축 나름대로 대충 요약및 번역 そこそこセキュアなlinuxサーバーを作る" />
<meta property="og:description" content="■ 그럭저럭 시큐어한 리눅스 서버구축 나름대로 대충 요약및 번역 そこそこセキュアなlinuxサーバーを作る" />
<link rel="canonical" href="http://localhost:4000/Security/security-linux/" />
<meta property="og:url" content="http://localhost:4000/Security/security-linux/" />
<meta property="og:site_name" content="Tech Stock" />
<script type="application/ld+json">
{"url":"http://localhost:4000/Security/security-linux/","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/siteicon.png"},"name":"hasune"},"headline":"보안을 염두한 Linux관리","author":{"@type":"Person","name":"hasune"},"description":"■ 그럭저럭 시큐어한 리눅스 서버구축 나름대로 대충 요약및 번역 そこそこセキュアなlinuxサーバーを作る","@type":"Article","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

		<link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Tech Stock" />

		<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Merriweather:400,400italic,700,700italic|Open+Sans:400,400italic,600,600italic,700,700italic|Inconsolata:400,700">
		<link rel="stylesheet" href="/css/main.css">
		<link rel="apple-touch-icon" href="/apple-touch-icon.png">
		<link rel="icon" type="image/png" href="/touch-icon.png" sizes="192x192">
		<link rel="icon" type="image/png" href="/images/favicon.png">

		
	</head>

	<body>
		<header>
			<h1>
				<a href="/"><img src="/images/emblem.svg" width="40" height="40" alt="Tech Stock logo"></a>
				Tech Stock
				<button type="button" class="open-nav" id="open-nav"></button>
			</h1>

			<form action="/search/" method="get">
				<input type="text" name="q" id="search-input" placeholder="Search" autofocus>
				<input type="submit" value="Search" style="display: none;">
			</form>

			<nav class="full-navigation">
				<ul>
					<li class="nav-item top-level ">
						
						<a href="/">건망증이 심한 엔지니어</a>
					</li>
				</ul>

				<ul>
					
					
						<li class="nav-item top-level ">
							
							<a href="/AWS&Azure&Heroku/AWS-Basic1/">AWS&Azure&Heroku</a>
							<ul>
								
									<li class="nav-item "><a href="/AWS&Azure&Heroku/AWS-Basic1/">AWS의 기본개념과 구조</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/Accident&Trouble/honbang-delete/">Accident&Trouble</a>
							<ul>
								
									<li class="nav-item "><a href="/Accident&Trouble/honbang-delete/">혼방 데이터 삭제하고 상황 회피</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/Awesome%20Blogger/Blogger/">Awesome Blogger</a>
							<ul>
								
									<li class="nav-item "><a href="/Awesome%20Blogger/Blogger/">학습과 커리어에 도움되는 블로거들</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/Git&Github/Git-Commit/">Git&Github</a>
							<ul>
								
									<li class="nav-item "><a href="/Git&Github/Git-Commit/">Git으로 커밋하기</a></li>
								
									<li class="nav-item "><a href="/Git&Github/Git-Branch/">Git에서 Branch관리</a></li>
								
									<li class="nav-item "><a href="/Git&Github/Git-Conflict/">Conflict관리</a></li>
								
									<li class="nav-item "><a href="/Git&Github/Git-Different-PullFetchClone/">Pull Fetch Clone Rebase Fork</a></li>
								
									<li class="nav-item "><a href="/Git&Github/Github-PullRequest/">GitHub의 PullRequest</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/IDE&Editor/Eclipse-shortcutkey/">IDE&Editor</a>
							<ul>
								
									<li class="nav-item "><a href="/IDE&Editor/Eclipse-shortcutkey/">Eclipse Shortcut Key</a></li>
								
									<li class="nav-item "><a href="/IDE&Editor/vi-vim-shorcutkey/">VI & VIM editor Shortcut key</a></li>
								
									<li class="nav-item "><a href="/IDE&Editor/VScode-Extends/">VScode 유용한 확장어플</a></li>
								
									<li class="nav-item "><a href="/IDE&Editor/VScode-setting/">VScode 유용한 설정들</a></li>
								
									<li class="nav-item "><a href="/IDE&Editor/VScode-shortcutkey/">VScode 유용한 단축키</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/Java/Array-List/">Java</a>
							<ul>
								
									<li class="nav-item "><a href="/Java/Array-List/">ArrayList 개념정리</a></li>
								
									<li class="nav-item "><a href="/Java/HashMap/">HashMap 개념정리</a></li>
								
									<li class="nav-item "><a href="/Java/Generic/">Generic이란 어떤놈인가</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/Linux/BashShell-Mybest/">Linux</a>
							<ul>
								
									<li class="nav-item "><a href="/Linux/BashShell-Mybest/">BashShell 젤 많이 썼던 놈들 정리</a></li>
								
									<li class="nav-item "><a href="/Linux/BashShell-ShortCutKey/">BashShell 기본단축키 정리</a></li>
								
									<li class="nav-item "><a href="/Linux/BashShell-Redirect/">BashShell 리다이렉트 정리</a></li>
								
									<li class="nav-item "><a href="/Linux/Curl-RESTfulAPI/">Curl 과 Restful API</a></li>
								
									<li class="nav-item "><a href="/Linux/etc-hosts/">Linux에서 /etc/hosts 에 대해</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/Mybatis/Basic-Structure/">Mybatis</a>
							<ul>
								
									<li class="nav-item "><a href="/Mybatis/Basic-Structure/">마이바티스의 기본구조</a></li>
								
									<li class="nav-item "><a href="/Mybatis/Basic1/">마이바티스의 기본사용</a></li>
								
									<li class="nav-item "><a href="/Mybatis/HandleResult/">대량쿼리문에 좋은 핸들 리절트</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/Oracle/JOIN/">Oracle</a>
							<ul>
								
									<li class="nav-item "><a href="/Oracle/JOIN/">Join</a></li>
								
									<li class="nav-item "><a href="/Oracle/SUB-QUERY/">Sub-query</a></li>
								
									<li class="nav-item "><a href="/Oracle/VIEW/">View</a></li>
								
									<li class="nav-item "><a href="/Oracle/INDEX/">Index</a></li>
								
									<li class="nav-item "><a href="/Oracle/SEQUENCE/">Sequence</a></li>
								
									<li class="nav-item "><a href="/Oracle/Operator/">Operator 기본(연산자)</a></li>
								
									<li class="nav-item "><a href="/Oracle/Function/">Function 기본 함수</a></li>
								
									<li class="nav-item "><a href="/Oracle/If-For-Case/">If문 For문 Case문</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/Performance/DB-Index1/">Performance</a>
							<ul>
								
									<li class="nav-item "><a href="/Performance/DB-Index1/">DB에서 Index를 통한 성능개선 1</a></li>
								
									<li class="nav-item "><a href="/Performance/DB-Index2/">DB에서 Index를 통한 성능개선 2</a></li>
								
									<li class="nav-item "><a href="/Performance/managed-programming/">성능을 염두한 프로그래밍</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/Postgres/JOIN/">Postgres</a>
							<ul>
								
									<li class="nav-item "><a href="/Postgres/JOIN/">Join 오라클과 비교</a></li>
								
									<li class="nav-item "><a href="/Postgres/SUB-QUERY/">Sub-query 오라클과 비교</a></li>
								
									<li class="nav-item "><a href="/Postgres/VIEW/">View 오라클과 비교</a></li>
								
									<li class="nav-item "><a href="/Postgres/INDEX/">Index 오라클과 비교</a></li>
								
									<li class="nav-item "><a href="/Postgres/SEQUENCE/">Sequence 오라클과 비교</a></li>
								
									<li class="nav-item "><a href="/Postgres/Operator/">Operator 기본(연산자) 오라클과 비교</a></li>
								
									<li class="nav-item "><a href="/Postgres/Function/">Function 오라클과 비교</a></li>
								
									<li class="nav-item "><a href="/Postgres/If-For-Case/">If문 For문 Case문 오라클과 비교</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/Regular%20expression/regexp-with-java/">Regular expression</a>
							<ul>
								
									<li class="nav-item "><a href="/Regular%20expression/regexp-with-java/">자바에서의 정규표현</a></li>
								
									<li class="nav-item "><a href="/Regular%20expression/regexp-with-linux/">리눅스 에서의 정규표현</a></li>
								
									<li class="nav-item "><a href="/Regular%20expression/regexp-with-oracle/">오라클 에서의 정규표현</a></li>
								
									<li class="nav-item "><a href="/Regular%20expression/regexp-with-postgres/">포스그레 에서의 정규표현</a></li>
								
									<li class="nav-item "><a href="/Regular%20expression/regexp-with-ruby/">루비 에서의 정규표현</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/Ruby/Rails-basic1/">Ruby</a>
							<ul>
								
									<li class="nav-item "><a href="/Ruby/Rails-basic1/">Rails 기초</a></li>
								
									<li class="nav-item "><a href="/Ruby/Rails-basic2/">scafflod 어떤놈이냐</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/Scrap/explain-scrap/">Scrap</a>
							<ul>
								
									<li class="nav-item "><a href="/Scrap/explain-scrap/">제대로된 설명</a></li>
								
									<li class="nav-item "><a href="/Scrap/Trendy-tool/">유행하는 툴</a></li>
								
									<li class="nav-item "><a href="/Scrap/video/">좋은 영상</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level current">
							
							<a href="/Security/EX/">Security</a>
							<ul>
								
									<li class="nav-item "><a href="/Security/EX/">해킹 유형과 사례</a></li>
								
									<li class="nav-item "><a href="/Security/security-DB/">보안을 염두한 DB관리</a></li>
								
									<li class="nav-item "><a href="/Security/security-coding/">보안을 염두한 프로그래밍</a></li>
								
									<li class="nav-item current"><a href="/Security/security-linux/">보안을 염두한 Linux관리</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/Spring/Basic-Structure1/">Spring</a>
							<ul>
								
									<li class="nav-item "><a href="/Spring/Basic-Structure1/">스프링 기본구조 1</a></li>
								
									<li class="nav-item "><a href="/Spring/Basic-Structure2/">스프링 기본구조 2</a></li>
								
									<li class="nav-item "><a href="/Spring/Dependency-Injection/">DI 의존주입</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/Sub-Project/1Day/">Sub-Project</a>
							<ul>
								
									<li class="nav-item "><a href="/Sub-Project/1Day/">서브프로젝트 첫날</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/Trend&News/2019-Stackoverflow/">Trend&News</a>
							<ul>
								
									<li class="nav-item "><a href="/Trend&News/2019-Stackoverflow/">2019 스택오버플로어 설문조사</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/Youtuber/Youtuber/">Youtuber</a>
							<ul>
								
									<li class="nav-item "><a href="/Youtuber/Youtuber/">학습과 커리어에 도움되는 유튜버</a></li>
								
							</ul>
						</li>
					
				</ul>

				<ul>
					<li class="nav-item top-level ">
						
						<a href="/changelog/">Change Log</a>
					</li>
				</ul>
			</nav>
		</header>

		<section class="main">
			<div class="page-header">
				<h2>Security</h2>
				<h3>보안을 염두한 Linux관리</h3>
			</div>
			<article class="content">
				<h5><p>■ 그럭저럭 시큐어한 리눅스 서버구축<br />
나름대로 대충 요약및 번역<br />
<a href="https://qiita.com/cocuh/items/e7c305ccffb6841d109c">そこそこセキュアなlinuxサーバーを作る</a></p>

<hr />
<hr />
<p>■ SSHD편</p>

<ul>
  <li>별 5개짜리 ★★★★★</li>
  <li>SSH표준포트 22는 너무 흔하니 반드시 바꿀것!
    <blockquote>
      <p>SSH표준 포트가 22번인데 너무 일반적이여서 bot공격의 대상이 되기 쉽다.<br />
(그렇지.. 중국 형님들이 bot공격 어마무시하게 잘 하시지..)<br />
그러하므로 22번 이외의 포트로 번호를 바꿔주는것이 좋다.<br />
대채 포트번호는 /etc/services 에 있는놈들 이외의 놈으로 해주면 되는데<br />
smtp라덩가 http등 유명한 놈들은 피해서 하는것이 좋다.</p>
    </blockquote>
  </li>
</ul>

<p>ex)</p>
<pre><code class="language-git">Port 1865
</code></pre>

<ul>
  <li>별 4개짜리 ★★★★</li>
  <li>SSH로는 root권한 로그인이 불가능하게 설정
    <blockquote>
      <p>sudo 라덩가 su 로 루트 권한이 되는것은 가능하나, 접속으로는 불가능하게 할것
default 치가 yes로 되어있는데 이것을 no 로 바꿔준다.</p>
    </blockquote>
  </li>
</ul>

<p>ex)</p>
<pre><code class="language-git">/etc/ssh/sshd_config
PermitRootLogin no
</code></pre>

<ul>
  <li>별 4개짜리 ★★★★</li>
  <li>패스워드 입력식 인증방식일경우 사전공격(dictionary attack)의 대상이 되므로 가능하면 사용하지 않는것이 좋다</li>
</ul>

<blockquote>
  <p>대채 인증방식으로는 공개키 인증방식이 있다.
공개키 방식으로 자신이 접속할 수 있도록 ~/.ssh/authorized_keys에 등록한후 끊지 않으면 접속이 닫히므로 주의가 요구된다
ssh-keygen 커맨드로 비밀키를 작성후, 클라이언트의 ~/.ssh/config에 등록하면 편리하다
공개키 등록은 ssh-copy-id커맨드를 사용하면 편하게 등록할 수 있다.</p>
</blockquote>

<p>ex)</p>
<pre><code class="language-git">/etc/ssh/sshd_config
PasswordAuthentication no
ChallengeResponseAuthentication no
PermitEmptyPasswords no  #공백 입력일 경우의 로그인 불허가
</code></pre>

<ul>
  <li>별 3개짜리 ★★★</li>
  <li>SSH접속이 가능한 유저를 한정한다.</li>
</ul>

<blockquote>
  <p>AllowUsers로는 Whitelist방식으로 설정이 가능하고
DenyUsers로는 Blacklist방식으로 설정이 가능하다
예를들어 웹어플을 web_app라는 유저 권한으로 운영할때
직접 web_app유저로 ssh접속할 필요는 없기 때문에 ssh불가능 하도록 설정한다</p>
</blockquote>

<pre><code class="language-git">/etc/ssh/sshd_config
AllowUsers hogeuser git
# DenyUsers web_app
</code></pre>

<ul>
  <li>별 2개짜리 ★★</li>
  <li>SSHD의 프로토콜을 2로 한다</li>
</ul>

<blockquote>
  <p>SSHD프로토콜 1의 경우에는 취약성이 발견되어서 서포터 안된다고 한다.
요즘에는 보통 기본값이 2로 되어있다. (그대로 내비두면 될듯)
오래된 리눅스버젼에서는 확인해볼 필요가 있다.</p>
</blockquote>

<pre><code class="language-git">/etc/ssh/sshd_config
Protocol 2
</code></pre>

<ul>
  <li>인증시의 시간이나 인증시도 횟수를 제한한다</li>
</ul>

<blockquote>
  <p>접속하고 인증할때까지의 유예시간(LoginGraceTime)과
인증시도 횟수(MaxAuthTries) 를 설정해두자</p>
</blockquote>

<pre><code class="language-git">/etc/ssh/sshd_config
LoginGraceTime 30
MaxAuthTries 3
</code></pre>

<ul>
  <li>sshguard, fail2ban 을 도입한다
    <blockquote>
      <p>sshguard, fail2ban은 공격을 감지하여 일정시간 액세스 거부를 할수 있다
ssh포트를 변경하지 않고 22번 포트 그대로 쓸때는 도입을 검토해볼 필요가 있다</p>
    </blockquote>
  </li>
</ul>

<hr />
<hr />

<p>■ firewall(iptables)편</p>

<p>firewall은 허가하지 않은 포트나 프로토콜을 액세스 거부하거나<br />
로그를 기록하거나 하는것이 가능하다.<br />
iptables만으로도 방대하므로 깊게 공부할 필요가 있을때는 따로 자료를 찾을것.<br />
man iptables 나 man iptables-extensitions 혹은<br />
마스터링 TCP/IP라는 불후의 명저가 있다.. ㅋㅋ<br />
(내 책장에 장식품 ㅋㅋ)</p>

<ul>
  <li>별 5개짜리 ★★★★★</li>
  <li>사용하지 않는 포트를 닫는다.</li>
</ul>

<blockquote>
  <p>iptables를 사용한다면 /etc/iptables/iptables.rules(ipv4)
/etc/iptables/ip6tables.rules(ipv6)설정파일이 있다
데비안 계열이면 /etc/iptables/rules.v4 인경우도 있다
밑의 경우는 iptables를 통해서 80번포트와 1234(ssh)포트를 열고있음</p>
</blockquote>

<pre><code class="language-git">/etc/iptables/iptables.rules
*filter
:INPUT DROP [0:0]
:FORWARD DROP [0:0]
:OUTPUT ACCEPT [0:0]
-A INPUT -p icmp -j ACCEPT 
-A INPUT -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT 
-A INPUT -i lo -j ACCEPT 

# Allow HTTP connection(port:80)
-A INPUT -p tcp --dport 80 -j ACCEPT

# Allow SSH connection(port:1234)
-A INPUT -p tcp --dport 1234 -j ACCEPT

-A INPUT -p tcp -j REJECT --reject-with tcp-reset 
-A INPUT -p udp -j REJECT --reject-with icmp-port-unreachable 
-A INPUT -j REJECT --reject-with icmp-proto-unreachable 
COMMIT
</code></pre>

<p>.<br />
.<br />
.<br />
일단 오늘은 요까지.. 잠온다.. 담에 또 이어서 적자..</p>

</h5>
				
  					<div id="disqus_thread"></div>
    <script>
        (function() { // DON'T EDIT BELOW THIS LINE
            var d = document, s = d.createElement('script');
            s.src = 'https://techstock-biz.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();
    </script>
<noscript>Please enable JavaScript to view the 
    <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>
                            
				
			</article>
		</section>

		<script>
			document.getElementById("open-nav").addEventListener("click", function () {
				document.body.classList.toggle("nav-open");
			});
		</script>
		<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-142178407-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-142178407-1');
</script>


	</body>
</html>
